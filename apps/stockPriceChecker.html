<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Price Checker</title>
</head>

<body>
    <h1>Stock Price Checker</h1>
    <p>Enter a stock ticker symbol:</p>
    <input type="text" id="stockTicker" placeholder="e.g., AAPL">
    <button onclick="fetchStockPrice()">Get Stock Price</button>
    <p id="stockPrice"></p>

    <script>
        function fetchStockPrice() {
            const apiKey = 'TLSO3IH1J3K0ID1Z'; // Replace with your AlphaVantage API Key
            const stockTicker = document.getElementById('stockTicker').value;
            const stockPriceDisplay = document.getElementById('stockPrice');

            // Check if a ticker was entered
            if (!stockTicker) {
                stockPriceDisplay.textContent = 'Please enter a stock ticker.';
                return;
            }

            // Construct the AlphaVantage API URL
            // const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${stockTicker}&interval=1min&apikey=${apiKey}`;
            const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY&symbol=${stockTicker}&apikey=${apiKey}`;

            // Make a GET request to the AlphaVantage API
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    if (data['Monthly Time Series']) {
                        // const latestData = data['Monthly Time Series'];
                        // const latestTime = Object.keys(latestData)[0];
                        // const stockPrice = latestData[latestTime]['2. high'];
                        // stockPriceDisplay.textContent = `Stock Price for ${stockTicker}: $${stockPrice}`;

                        // const highValues = Object.values(data["Monthly Time Series"]).map(entry => parseFloat(entry["2. high"]));
                        // const highestHigh = Math.max(...highValues);
                        // stockPriceDisplay.textContent = `Stock Price for ${stockTicker}: $${highestHigh}`;

                        // Extract the first 3 entries and find the highest "high" value
                        const entries = Object.entries(data["Monthly Time Series"]);
                        const first3Entries = entries.slice(0, 30);

                        let highestHigh = 0;

                        for (const [date, values] of first3Entries) {
                            const high = parseFloat(values["2. high"]);
                            if (high > highestHigh) {
                                highestHigh = high;
                            }
                        }

                        stockPriceDisplay.textContent = `Stock Price for ${stockTicker}: $${highestHigh}`;
                    } else {
                        stockPriceDisplay.textContent = `Stock data not found for ${stockTicker}`;
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                    stockPriceDisplay.textContent = 'An error occurred while fetching stock data.';
                });
        }
    </script>
</body>

</html>